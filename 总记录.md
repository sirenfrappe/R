# 步骤
## 1.从dbptm数据库analysis栏中的疾病相关页面中爬取所有疾病相关的ID
R的`rvest`包不能很好的读取不同页面，爬取出来的网页都是第一页。因此选用把所有网页保存至本地的方法然后再爬取数据。该网页中存在一些点击后无对应数据库内容的蛋白，需要进行筛选。
```R
library(rvest)
library(xml2)
library(magrittr)

ID <- NULL

for (i in 1:15) {
  URL <- paste("D:/idps/data/dbPTM/muluWeb/dbPTM", i, ".html", sep = "")
  page <- read_html(URL)
  table <-
    data.frame(html_table(
      page %>% html_nodes(".table-responsive") %>% html_nodes("table"),
      header = TRUE
    ))
  ID <- c(ID, unique(table[, 1]))
}
ID <- unique(ID)

#ID为含有疾病相关PTM的蛋白的uniprotID
#其中部分为dbPTM 中没有信息的ID
#下面进行无信息ID的筛除

temp <- NULL
for (i in 88:length(ID)) {
  cat(i, "\t", "开始", "\t")
  URL <-
    paste("http://dbptm.mbc.nctu.edu.tw/info.php?id=", ID[i], sep = "")
  
  page <- read_html(URL)
  cat("url wancheng\t")
  Nnodes <- page %>% html_nodes(".panel-body")
  
  cat("节点完毕\t")
  if (length(Nnodes) == 1) {
    temp <- c(temp, i)
    cat("空数据", "\t")
  }
  cat("jieshu \t")
  cat(ID[i], "\n")
  Sys.sleep(5)
}

ID <- ID[-temp]
```
共统计出143个蛋白。
## 2.对具体的每个ID进行数据爬取
根据得到的143个ID，到ID相应的界面对想要的内容进行爬取。
[zhushi.R](zuhshi.R)是爬取蛋白信息整合为dataframe的脚本。
在[DeRelated-func-chuli](DeRelated-func-chuli.R)中对`zhushi.R`中的函数进行调用，将全部143个蛋白信息进行爬取。爬取结果存放在`output/UniID/`文件夹下。

# 一些问题
## 1突变信息不一致
有些位点的突变信息存在突变信息不一致的问题，疾病栏的突变信息和总览下的突变信息不一致，详细位点信息在`output/yichangzhi.txt`下。推测是isoform导致。
